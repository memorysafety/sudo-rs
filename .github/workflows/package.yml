name: Packaging

on:
  push:
  workflow_dispatch:

jobs:
  package:
    uses: NLnetLabs/ploutos/.github/workflows/pkg-rust.yml@v7
    with:
      package_build_rules: |
        pkg: sudo
        image:
          - "ubuntu:jammy"
          - "rockylinux:8"
        target:
          - x86_64-unknown-linux-gnu
          - aarch64-unknown-linux-gnu
          - armv7-unknown-linux-gnu

      package_test_scripts_path: pkg/tests/test-sudo.sh

      deb_extra_build_packages: libpam-dev
      rpm_extra_build_packages: pam-devel
      rpm_scriptlets_path: pkg/rpm/scriptlets.toml


